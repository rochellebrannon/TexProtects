

<!DOCTYPE html>
<!--
  Copyright 2011 Google Inc. All Rights Reserved.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<html>
  <head>
    <meta charset="UTF-8">

    <title>Fusion Tables API Example: Google Chart Tools</title>


    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
	  
	  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script>
	$.urlParam = function(name){
    var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);
    if (results==null){
       return null;
    }
    else{
       return results[1] || 0;
    }
	}
$(document).ready(function () {

    function exportTableToCSV($table, filename) {

        var $rows = $table.find('tr:has(td),tr:has(th)'),

            // Temporary delimiter characters unlikely to be typed by keyboard
            // This is to avoid accidentally splitting the actual contents
            tmpColDelim = String.fromCharCode(11), // vertical tab character
            tmpRowDelim = String.fromCharCode(0), // null character

            // actual delimiter characters for CSV format
            colDelim = '","',
            rowDelim = '"\r\n"',

            // Grab text from table into CSV formatted string
            csv = '"' + $rows.map(function (i, row) {
                var $row = $(row),
                    $cols = $row.find('td,th');

                return $cols.map(function (j, col) {
                    var $col = $(col),
                        text = $col.text();

                    return text.replace(/"/g, '""'); // escape double quotes

                }).get().join(tmpColDelim);

            }).get().join(tmpRowDelim)
                .split(tmpRowDelim).join(rowDelim)
                .split(tmpColDelim).join(colDelim) + '"',

            // Data URI
            csvData = 'data:application/csv;charset=utf-8,' + encodeURIComponent(csv);

        $(this)
            .attr({
            'download': filename,
                'href': csvData,
                'target': '_blank'
        });
		
		
		
		
		
    }

    // This must be a hyperlink
    $(".export").on('click', function (event) {
        // CSV
        exportTableToCSV.apply(this, [$('#ft-data>table'), 'export.csv']);
        
        // IF CSV, don't do event.preventDefault() or return false
        // We actually need this to be a typical hyperlink
    });
});
</script>

    <style type="text/css">
    


		
		
		table {
		margin-bottom: 20px;
			background: #52be7f;
		border-collapse:collapse;
		font-family: 'Lato', Calibri, Arial, sans-serif;
		border: none;
                border-radius: 3px;
               -webkit-border-radius: 3px;
               -moz-border-radius: 3px;
	}
	th, td {
		box-shadow: inset 0 -1px rgba(0,0,0,0.25), 
			inset 0 1px rgba(0,0,0,0.25);
	}
	 th {
		font-weight: normal;
		-webkit-font-smoothing: antialiased;
		padding: 1em;
		color: rgba(0,0,0,0.45);
		text-shadow: 0 0 1px rgba(0,0,0,0.1);
		font-size: 1.5em;
	}
	td {
		color: #f7f7f7;
		padding: 0.7em 1em 0.7em 1.15em;
		text-shadow: 0 0 1px rgba(255,255,255,0.1);
		font-size: 1.4em;
	}
	 tr {
		-webkit-transition: background 0.3s, box-shadow 0.3s;
		-moz-transition: background 0.3s, box-shadow 0.3s;
		transition: background 0.3s, box-shadow 0.3s;
	}
	

	tr:hover {
		background: rgba(0,0,0,0.1);
	}
		
		
		
    </style>

    <script type="text/javascript">
      google.load('visualization', '1');

      function drawTable() {
        // Construct query
        var query = "SELECT  *" +
            'FROM 1-saIAOXhsY3Sc6WPvYL5SsJ_U0S94OerpG-Wt6tq';
		  //var query = "SELECT  'ZCTA','Corresponding Counties','Poverty < 18','Poverty < 5','Teen Births','Substance Abuse','CAN Fatalities','Substantiated < 18','Substantiated < 6','Mean of Rankings (all)' ,'Rank Order of Means (Overall Risk Ranking)'" +
            //'FROM 1-saIAOXhsY3Sc6WPvYL5SsJ_U0S94OerpG-Wt6tq';
	 var team = document.getElementById('team').value;
        if (team) {
          query += " WHERE 'Corresponding Counties' CONTAINS IGNORING CASE '" + team + "'";
        }
        var queryText = encodeURIComponent(query);
        var gvizQuery = new google.visualization.Query(
            'https://www.google.com/fusiontables/gvizdata?tq='  + queryText);

        // Send query and draw table with data in response
        gvizQuery.send(function(response) {
          var numRows = response.getDataTable().getNumberOfRows();
          var numCols = response.getDataTable().getNumberOfColumns();
			

          var ftdata = ['<table><thead><tr>'];
          for (var i = 0; i < numCols; i++) {
            var columnTitle = response.getDataTable().getColumnLabel(i);
            ftdata.push('<th>' + columnTitle + '</th>');
          }
          ftdata.push('</tr></thead><tbody>');

          for (var i = 0; i < numRows; i++) {
            ftdata.push('<tr>');
			  
            for(var j = 0; j < numCols; j++) {
              var rowValue = response.getDataTable().getValue(i, j);
              ftdata.push('<td>' + rowValue + '</td>');
            }
            ftdata.push('</tr>');
          }
			
			
			
			
					   
          ftdata.push('</tbody></table>');
          document.getElementById('ft-data').innerHTML = ftdata.join('');
        });
      }

      google.setOnLoadCallback(drawTable);
    </script>
  </head>
  <body>
    <div>
      <label>Scoring Team:</label>
		 <input type="text" id="team" onchange="drawTable();" list="counties" class="inputtext" style="width: 162.5px;">
		<datalist id="counties"> <option value="Anderson"> <option value="Andrews"> <option value="Angelina"> <option value="Aransas"> <option value="Archer"> <option value="Armstrong"> <option value="Atascosa"> <option value="Austin"> <option value="Bailey"> <option value="Bandera"> <option value="Bastrop"> <option value="Baylor"> <option value="Bee"> <option value="Bell"> <option value="Bexar"> <option value="Blanco"> <option value="Borden"> <option value="Bosque"> <option value="Bowie"> <option value="Brazoria"> <option value="Brazos"> <option value="Brewster"> <option value="Briscoe"> <option value="Brooks"> <option value="Brown"> <option value="Burleson"> <option value="Burnet"> <option value="Caldwell"> <option value="Calhoun"> <option value="Callahan"> <option value="Cameron"> <option value="Camp"> <option value="Carson"> <option value="Cass"> <option value="Castro"> <option value="Chambers"> <option value="Cherokee"> <option value="Childress"> <option value="Clay"> <option value="Cochran"> <option value="Coke"> <option value="Coleman"> <option value="Collin"> <option value="Collingsworth"> <option value="Colorado"> <option value="Comal"> <option value="Comanche"> <option value="Concho"> <option value="Cooke"> <option value="Coryell"> <option value="Cottle"> <option value="Crane"> <option value="Crockett"> <option value="Crosby"> <option value="Culberson"> <option value="Dallam"> <option value="Dallas"> <option value="Dawson"> <option value="DeWitt"> <option value="Deaf Smith"> <option value="Delta"> <option value="Denton"> <option value="Dickens"> <option value="Dimmit"> <option value="Donley"> <option value="Duval"> <option value="Eastland"> <option value="Ector"> <option value="Edwards"> <option value="Ellis"> <option value="El Paso"> <option value="Erath"> <option value="Falls"> <option value="Fannin"> <option value="Fayette"> <option value="Fisher"> <option value="Floyd"> <option value="Foard"> <option value="Fort Bend"> <option value="Franklin"> <option value="Freestone"> <option value="Frio"> <option value="Gaines"> <option value="Galveston"> <option value="Garza"> <option value="Gillespie"> <option value="Glasscock"> <option value="Goliad"> <option value="Gonzales"> <option value="Gray"> <option value="Grayson"> <option value="Gregg"> <option value="Grimes"> <option value="Guadalupe"> <option value="Hale"> <option value="Hall"> <option value="Hamilton"> <option value="Hansford"> <option value="Hardeman"> <option value="Hardin"> <option value="Harris"> <option value="Harrison"> <option value="Hartley"> <option value="Haskell"> <option value="Hays"> <option value="Hemphill"> <option value="Henderson"> <option value="Hidalgo"> <option value="Hill"> <option value="Hockley"> <option value="Hood"> <option value="Hopkins"> <option value="Houston"> <option value="Howard"> <option value="Hudspeth"> <option value="Hunt"> <option value="Hutchinson"> <option value="Irion"> <option value="Jack"> <option value="Jackson"> <option value="Jasper"> <option value="Jeff Davis"> <option value="Jefferson"> <option value="Jim Hogg"> <option value="Jim Wells"> <option value="Johnson"> <option value="Jones"> <option value="Karnes"> <option value="Kaufman"> <option value="Kendall"> <option value="Kenedy"> <option value="Kent"> <option value="Kerr"> <option value="Kimble"> <option value="King"> <option value="Kinney"> <option value="Kleberg"> <option value="Knox"> <option value="La Salle"> <option value="Lamar"> <option value="Lamb"> <option value="Lampasas"> <option value="Lavaca"> <option value="Lee"> <option value="Leon"> <option value="Liberty"> <option value="Limestone"> <option value="Lipscomb"> <option value="Live Oak"> <option value="Llano"> <option value="Loving"> <option value="Lubbock"> <option value="Lynn"> <option value="McCulloch"> <option value="McLennan"> <option value="McMullen"> <option value="Madison"> <option value="Marion"> <option value="Martin"> <option value="Mason"> <option value="Matagorda"> <option value="Maverick"> <option value="Medina"> <option value="Menard"> <option value="Midland"> <option value="Milam"> <option value="Mills"> <option value="Mitchell"> <option value="Montague"> <option value="Montgomery"> <option value="Moore"> <option value="Morris"> <option value="Motley"> <option value="Nacogdoches"> <option value="Navarro"> <option value="Newton"> <option value="Nolan"> <option value="Nueces"> <option value="Ochiltree"> <option value="Oldham"> <option value="Orange"> <option value="Palo Pinto"> <option value="Panola"> <option value="Parker"> <option value="Parmer"> <option value="Pecos"> <option value="Polk"> <option value="Potter"> <option value="Presidio"> <option value="Rains"> <option value="Randall"> <option value="Reagan"> <option value="Real"> <option value="Red River"> <option value="Reeves"> <option value="Refugio"> <option value="Roberts"> <option value="Robertson"> <option value="Rockwall"> <option value="Runnels"> <option value="Rusk"> <option value="Sabine"> <option value="San Augustine"> <option value="San Jacinto"> <option value="San Patricio"> <option value="San Saba"> <option value="Schleicher"> <option value="Scurry"> <option value="Shackelford"> <option value="Shelby"> <option value="Sherman"> <option value="Smith"> <option value="Somervell"> <option value="Starr"> <option value="Stephens"> <option value="Sterling"> <option value="Stonewall"> <option value="Sutton"> <option value="Swisher"> <option value="Tarrant"> <option value="Taylor"> <option value="Terrell"> <option value="Terry"> <option value="Throckmorton"> <option value="Titus"> <option value="Tom Green"> <option value="Travis"> <option value="Trinity"> <option value="Tyler"> <option value="Upshur"> <option value="Upton"> <option value="Uvalde"> <option value="Val Verde"> <option value="Van Zandt"> <option value="Victoria"> <option value="Walker"> <option value="Waller"> <option value="Ward"> <option value="Washington"> <option value="Webb"> <option value="Wharton"> <option value="Wheeler"> <option value="Wichita"> <option value="Wilbarger"> <option value="Willacy"> <option value="Williamson"> <option value="Wilson"> <option value="Winkler"> <option value="Wise"> <option value="Wood"> <option value="Yoakum"> <option value="Young"> <option value="Zapata"> <option value="Zavala"> </datalist>

      
    </div>
	  <a href="#" class="export">Export Table data into Excel</a>
    <div id="ft-data"></div>
  </body>
</html>
